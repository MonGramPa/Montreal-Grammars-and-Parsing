<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Noisy channel model</title>

    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/node_modules/codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="/node_modules/codemirror/theme/neat.css">
    <link rel="stylesheet" href="/assets/css/katex.min.css">
    <link rel="stylesheet" href="/assets/css/custom.css">
    <link rel="stylesheet" href="/assets/css/code.css">

    <script src="/assets/js/webchurch.min.js"></script>
    <script src="/assets/js/katex.min.js"></script>
    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/node_modules/codemirror/lib/codemirror.js"></script>
    <script src="/node_modules/codemirror/mode/javascript/javascript.js"></script>
    <script src="/assets/js/cm-folding.js"></script>
    <script src="/assets/js/cm-comments.js"></script>
    <script src="/assets/js/webppl.min.js"></script>
    <script src="/bower_components/jquery-autosize/jquery.autosize.min.js"></script>
    <script src="/bower_components/d3/d3.min.js"></script>
    <script src="/bower_components/vega/vega.min.js"></script>
    <!-- <script src="https://probmods.org/webchurch/online/vega.min.js"></script> -->
    <script src="/bower_components/underscore/underscore.js"></script>
    <script src="/bower_components/react/JSXTransformer.js"></script>
    <script src="/bower_components/react/react-with-addons.min.js"></script>
    <script src="/bower_components/showdown/compressed/showdown.js"></script>
    <script src="/assets/js/custom.js"></script>
    <script type="text/jsx" src="/assets/js/editor.js"></script>

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>

    <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="/">Montreal Grammars and Parsing Project</a>
        </div>
        <ul class="nav navbar-nav navbar-right collapse navbar-collapse">
            <li><a href="/editor.html">Editor</a></li>
        </ul>
      </div>

    </div>

    <div class="container">

      <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<div class="page-header">
  <h1>Noisy channel model</h1>
  
</div>

<h1 id="adding-in-the-noisy-channel">Adding in the noisy channel</h1>

<h2 id="changes-to-the-generative-model">Changes to the Generative Model</h2>
<p>Recall the original generative model was:</p>

<center>
$$\begin{aligned}
P(X\mid Z, \Phi)P(Z\mid \Phi) = P(X\mid z', z_a, \Theta, \nu, a, b, \alpha)P(Z\mid G, a,b,\alpha)= \\
P(X\mid z', z_A, G, \nu, \Theta, a, b, \alpha) \\
\times P(z' \mid  z_a, G, \nu, \Theta, a, b, \alpha) \\
\times P(z_a \mid  G, \nu, \Theta, a,b,\alpha) \\
\times P(\nu \mid  a,b)\\
\times P(\Theta\mid \alpha) \end{aligned}$$
</center>

<p>Since the actual ``data’’ in the joint model are top level PLUs, let’s change the notation a bit for the sake of consistency:
Let:
    - <script type="math/tex">Y</script> be the <strong>bottom-level PLUs</strong> produced by the adaptor grammar model (written as <script type="math/tex">X</script> above)
    - <script type="math/tex">X</script> be the new data being generated by the model, the <strong>top-level PLUs</strong>.</p>

<p>For brevity, let <script type="math/tex">\mathcal{T}</script> be the set of nonterminals which expand to top-layer PLUs.
We need to re-specify our latent variables and hyperparameters as well.</p>
<ul>
  <li>Let <script type="math/tex">Z</script> be our set of hidden variable collections:
    <ul>
      <li><script type="math/tex">\Theta_{bot} = \{\Theta_A \mid  A \in \mathcal{N}-\mathcal{T}\}</script>: PCFG Multinomials for non-terminal expansions (bottom layer PLUs)</li>
      <li><script type="math/tex">\Theta_{top} = \{\Theta_A \mid A \in \mathcal{T}\}</script>: PCFG multinomials for terminal expansions (top-layer PLUs).</li>
      <li><script type="math/tex">\nu = \{\nu_A \mid  A \in \mathcal{M}\}</script>: stick length proportions</li>
      <li><script type="math/tex">z_a = \{z_{A,i} \mid  A \in M, i \in \{1,...\} \}</script>: adapted nonterminal’s subtrees</li>
      <li><script type="math/tex">z' = \{z_A \mid  A \in \mathcal{M}\}</script>: the full tree derivations</li>
    </ul>
  </li>
  <li>For hyperparameters:
    <ul>
      <li>add a parameter <script type="math/tex">\alpha_{top}</script> which parameterizes the Dirichlet process generating <script type="math/tex">\Theta_{top}</script>.</li>
      <li>add a parameter <script type="math/tex">G_{top}</script> which is the noisy channel grammar, including rewrite, substitution, and deletion rules.</li>
      <li>similarly, let <script type="math/tex">\alpha</script> in the original model and <script type="math/tex">G</script> become <script type="math/tex">\alpha_{bot}</script> and <script type="math/tex">G_{bot}</script> respectively.</li>
    </ul>
  </li>
</ul>

<p>First, let’s rewrite our original generative model in terms of these new variables:</p>

<center>
$$\begin{aligned}
P(Y\mid Z, \Phi)P(Z\mid \Phi) = P(Y\mid z', z_a, \Theta_{bot}, \nu, a, b, \alpha_{bot})P(Z\mid G_{bot}, a,b,\alpha_{bot})= \\
P(X\mid z', z_A, G_{bot}, \nu, \Theta_{bot}, a, b, \alpha_{bot}) \\
\times P(z' \mid  z_a, G_{bot}, \nu, \Theta_{bot}, a, b, \alpha_{bot}) \\
\times P(z_a \mid  G_{bot}, \nu, \Theta_{bot}, a,b,\alpha_{bot}) \\
\times P(\nu \mid  a,b)\\
\times P(\Theta_{bot}\mid \alpha_{bot}) \end{aligned}$$
</center>

<p>Now in addition, we are adding another layer to the top, namely <script type="math/tex">P(X|Y, Z, \Phi)</script>. If we think about what <script type="math/tex">X</script> depends on, we can expand this to get</p>
<center>
$$\begin{aligned}
P(X | Y, G_{top}, \Theta_{top}, \alpha_{top}) \\
\times  P(\Theta_{top}|\alpha_{top})\\
\times P(Y|Z, \Phi)P(Z | \Phi)
\end{aligned}
$$
</center>

<p>Thankfully, the last part is just our original generative model, so the whole model rewrites to:</p>

<center>
$$\begin{aligned}
P(X | Y, G_{top}, \Theta_{top}, \alpha_{top}) \\
\times  P(\Theta_{top}|\alpha_{top})\\
P(Y\mid z', z_a, \Theta_{bot}, \nu, a, b, \alpha_{bot})P(Z\mid G_{bot}, a,b,\alpha_{bot})= \\
P(X\mid z', z_A, G_{bot}, \nu, \Theta_{bot}, a, b, \alpha_{bot}) \\
\times P(z' \mid  z_a, G_{bot}, \nu, \Theta_{bot}, a, b, \alpha_{bot}) \\
\times P(z_a \mid  G_{bot}, \nu, \Theta_{bot}, a,b,\alpha_{bot}) \\
\times P(\nu \mid  a,b)\\
\times P(\Theta_{bot}\mid \alpha_{bot})

\end{aligned}
$$
</center>

<h2 id="updates">Updates</h2>
<p>Applying the variational methodology to this model, since we only have one added latent variable (<script type="math/tex">\Theta_{top}</script>) we need only to find one new variational distribution. Call this distribution <script type="math/tex">q_{\tau_n}(\Theta_{top})</script>. The update for this parameter <script type="math/tex">\tau_n</script> will be very similar to the update of the variational parameter indexed by <script type="math/tex">\Theta_{bot}</script> in the original model:</p>

<center>
$$\begin{aligned}
\tau_{n, A\rightarrow \beta} = \sum\limits_{B\in \mathcal{T}} \sum\limits_{k=1}^{N_B} \tilde{f}(A\rightarrow \beta, S_{B,k})
\end{aligned}$$
</center>

<p>where <script type="math/tex">\tilde{f}(A\rightarrow \beta, S_{B,k})</script> is the expected number of times the rule <script type="math/tex">A\rightarrow \beta</script> appears in the derivation <script type="math/tex">S_{B,k}</script></p>


        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true,
    }
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>


    </div><!-- /.container -->

  </body>
</html>
